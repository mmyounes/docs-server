== Release 8.0.0 (December 2024)


Couchbase Server 8.0.0  was released in December 2024. This maintenance release contains new features and fixes several known issues.

For detailed information on new features and enhancements, please see xref:introduction:whats-new.adoc[].

[#section-fixed-issues-800]
=== Fixed Issues

This release contains the following fixes:

[#section-fixed-issuses-800-data-service]

==== Data Service

https://jira.issues.couchbase.com/browse/MB-63946[MB-63946]::
When using `mcstat` it is no longer possible to use `--json=pretty`.
The request to pretty-print the JSON is ignored
+
Users can use a pipe in conjunction with an external formatting tool such as `jq` to obtain formatted output:
+
[source, shell]
----
./mcstat [options] --json [statgroup] | jq .
----

[#section-fixed-issues-800-XDCR]
==== XDCR

https://jira.issues.couchbase.com/browse/MB-23798[MB-23798]::
If users do not want the replication to be automatically deleted upon either source or bucket deletion and/or recreation,
they can set the `skipReplSpecAutoGc` replication setting to true upon replication creation.
In the situation that the replication would have been deleted, it will have been automatically paused instead,
and a persistent UI error message is logged to be viewed.
Users are expected to manually execute the recovery action by deleting the replication and re-creating a newer one, if necessary.

https://jira.issues.couchbase.com/browse/MB-55758[MB-55758]::
*Issue:* In very rare situations, a document with a very large CAS could be inserted into a bucket.
It would then be possible for XDCR to replicate this document with malformed CAS to other clusters.
+
*Solution:*
XDCR now has a built-in guardrail to prevent documents with malformed CAS beyond a certain drift threshold from being replicated
and notifies the user if this situation occurs via UI and logs.

https://jira.issues.couchbase.com/browse/MB-58809[MB-58809]::
The Remote Cluster Service may be stuck and unable to update references modified by another node in the cluster.
+
*Resolution:* Ensure the resync takes place if the remote cluster metadata is out of sync to prevent references from being stuck in a stale state.
https://jira.issues.couchbase.com/browse/MB-60186[MB-60186]::
XDCR shutdown may cause a deadlock between DCP nozzle and statsMgr, leading to stuck go-routines

https://jira.issues.couchbase.com/browse/MB-60448[MB-60448]::
When the  `goxdcr` process was killed in a paused replication state, `changes_left` were left as negative.

https://jira.issues.couchbase.com/browse/MB-60674[MB-60674]::
JSON documents with ending with whitespaces were considered as invalid and were not eligible for advanced filtering.

https://jira.issues.couchbase.com/browse/MB-60920[MB-60920]::
XDCR backfill pipeline could contain null tasks, leading to the unnecessary triggering of the backfill pipeline.

https://jira.issues.couchbase.com/browse/MB-60992[MB-60992]::
Replication deletion may become stuck and not complete due to BackfillMgr not starting properly.

https://jira.issues.couchbase.com/browse/MB-61312[MB-61312]::
XDCR connection pre-check now supports alternate addresses,
DNS SRV and works identically to how XDCR remote cluster reference behaves.

https://jira.issues.couchbase.com/browse/MB-61378[MB-61378]::
If a replication is deleted when a backfill pipeline is running,
there's a possibility that the stats related to the backfill pipeline will remain and not properly be deleted and reset to 0

https://jira.issues.couchbase.com/browse/MB-61575[MB-61575]::
When the target cluster performs a certificate rotation after a pre-check run,
the subsequent pre-check call will fail due to its caching of the old certificates

https://jira.issues.couchbase.com/browse/MB-61657[MB-61657]::
XDCR on Non-KV nodes may have a goroutine stuck due to the lack of listeners on a service channel.

https://jira.issues.couchbase.com/browse/MB-61949[MB-61949]::
When none of the nodes in the remote reference DNS SRV entry is reachable,
XDCR could be stuck working off of a stale list of nodes.
Now, XDCR can re-bootstrap from the top DNS SRV entry

https://jira.issues.couchbase.com/browse/MB-61976[MB-61976]::
When connectivity errors that show up on the UI are corrected,
the error may remain indefinitely even if the original connectivity issue has been repaired.
This is fixed: errors on the UI will correctly disappear once connectivity issues have been solved.

https://jira.issues.couchbase.com/browse/MB-61977[MB-61977]::
After a rebalance is performed on the target cluster, following a topology change,
XDCR will have an updated node list to keep track of the connectivity statuses of the target cluster nodes.

https://jira.issues.couchbase.com/browse/MB-62092[MB-62092]::
When a pipeline is unable to start, `Prometheus` metrics did not capture the errors and the error state. 
Now, the `Prometheus` stats will correctly log the situation as in error as well as the error count.

https://jira.issues.couchbase.com/browse/MB-62294[MB-62294]::
Tombstones were not replicated if the binary filter is turned on. 
This  has been fixed;  tombstones are now replicated properly.

https://jira.issues.couchbase.com/browse/MB-63527[MB-63527]::
XDCR dashboard on Source cluster now shows a UI alert
when a pipeline is stuck due to EACCESS errors while writing to Target cluster.



[#section-fixed-issues-800-query-service]
==== Query Service

https://jira.issues.couchbase.com/browse/MB-51623[MB-51623]::
If the query uses a legacy `LOOK UP JOIN`, sub-paths can be missing.
Expiration must get expiration through sub document API.
However, in the case of `JOIN` it only gets this through the Fetch Phase on the right side of the query.
This can cause expiration to be incorrectly returned as 0.


https://jira.issues.couchbase.com/browse/MB-51629[MB-51629]::
 Large negative integers with 19 significant digits but still below the limits of 64-bit int storage were treated as floating point and thus were subject to precision loss.
 
[#section-fixed-issues-800-tools]

==== Tools

https://jira.issues.couchbase.com/browse/MB-60337[MB-60337]::
Previously, it was possible to remove backups which would cause dependent incremental backups to become invalid if they depended on those deleted backups. With this release, such deletes are prevented by default, but can be overridden with the new --disable-safe-remove-check flag

https://jira.issues.couchbase.com/browse/MB-60676[MB-60676]::
When there are multiple backup service nodes in a cluster, we now prevent more than one job for a repo being run concurrently.
Previously this could happen, even though it always results in one of the jobs failing.

 





